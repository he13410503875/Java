# Follow-up work



## 1、如何发版【平安云】【招商云】【生产环境】?

> ＠余娟娟  9533a650  请帮忙发布下(SCCT+JM)港口后端平安云环境。修改了配置文件...(截图)
>
> ＠刘成  9533a650  请帮忙发布下(SCCT+JM)港口后端招商云环境。修改了配置文件…(截图)

1、娟娟是发平安云的，刘成是发招商云的。平安云可以随时发，招商云都是走文件外发的，统一时间段发。(下

班后。)

2、如果改了配置文件。就在 config的jm，scc港口里两个环境stg平安云，uat招商云。把开发环境下修改的配置文件代码也一一复制到这两个环境对应的配置文件下(例如:邮件发送)。最后截图.

3、如果添加了sqi语句，在db的jm，sct港口里，新建当前时间文件。把sq语句分别复制一份到两个港口下，sq语句都是刘成在发布和维护。(发群里的时候要说明是执行港口的sqi语句，不然还有监管的。会搞混!也要把分支版本号写上。)

4、＠all再强调一下哈不论是否实货测试期间，动生产，需要连总批(需要发啥应用修改了什么写出了有啥影响＠连总)



### 1.1、一个功能开发完成以后，一个正常的测试发版流程：

1、功能开发完，自己本地测试完，提交代码。之后就是上测试环境测试。。

2、先平安云，再招商云，最后上生产。群里会统一一个时间上测试，也会统一一个时间上生产。

3、所以不用在群里艾特发平安，发招商，发生产。正常提交代码，就会按时间走流程。所以只需要把每日工作完成度发邮件即可. 例外就是发版期间，娟娟可以平安云任发。



## 2、邮件下发的修改邮箱地址信息保存下来

具实在 Confluence上有记录这些信息





## 3、去蛇口港现场支持。

1)8001端口就是启动的jar服务

2)测试是否正常启动的链接地址是http:// localhost:8001/job,輸入网址点击确认会一片空白。之后再去home文件夹下的log文件夹里查看当前时间日志。。看看是否在当前的时间 job finished.了，是，则服务正常启动

3)10.130.0.131是SCCT那边做了nat转換，转换之前的ip是10.1.0.157



### CMD命令:

1) pingle通ip地址的端口号，用cmd命令 telnet 10.1.0.157 8092(不要”:冒号)

2)查看所有端口的cmd命令( netstat-ano)



### 开jar包服务:

1)杨杨已经把jar包外发到某个链接上，先在pafc把jar包下载下来，然后用邮件发给老师，甄老师再持贝到

服务器上

2)到蛇口后，在 develop里新建当前日期文件夹(如:1015)，把最近日期文件夹里的 config配置文件持贝过

来(注意:157是prd生产，158是uat测试。)，再解压 merchants-data-fetch-server. jar包，把里面的最新0点中

3)把最近日期文件夹里的bat文件拷贝过来，改里面jar包名，点击bat文件，启动ar包服务。。157、158都要

启动服务

4)最后把bat文件放入”启动文件夹，完成服务开机自启动。

5)服务启动后，要查看日志是否有报错

####  Tips:

> 1、启动完jar服务，过一会再看任务管理器。。jar服务自动消失了
>
> 解:因为没把最近日期文件夹里的 config配置文件拷贝过来，导致jar服务启动失败
>
> 2、报错信息: Invalid bound bound statement( not foundl com. merchants. getch mapper. Tcontexportmapper insertone
>
> 解:显示有个插入语句找不到。因为没有把最新jar包里的 mapper文件拷贝出来导致的。
>

###  

### nginx

1)157的端口是8001，158的端口是8002



### 上链:

1)四点多问了老师出口表里是有12条数据。但要等五点多真实的船只靠了岸，卸了船之后。蛇口这的卸船表里有视图数据了，我们再完成上链操作.



## 5、去海关大厦现场支持。

1)部署 Tomcat:服务:去8楼生产环境，先备份复制一下旧包，然后替换前端包，重启服务，查看修改效果。把

H4A改成 false，就不用账号登录了。





## 6、如何发版/上线 merchants- dataex- server?

1、这是 dataex，不用跑到蛇口去。

2、生产发版找刘成/晓磊，如果是平安云就直接艾特一下娟娟/龚春燕(版本分支配置是否有更新都说下)



### 6.1、如何测试 dataex- server?

1.提交发布到平安云。(平安云上也有蛇口港的服务。)

2.要看 Ifetch服务的de文件，我们开发环境有 oracle数据库，然后先本地测试本地测完之后再上，(打开 eruekal服务，打开 data-fetchk服务，打开 dataex- server服务，)

3、平安本地开发环境可以测，平安测试环境不了。源库是 orcal数据库里的: V_CONT_OPTIN(开发环境下测试要把前缀去掉)，目标库是开发环境 mysql里的: Port ship_ unloading

4、在库里入数据，看目标库是否同步数据成功即可。







































































































































































































